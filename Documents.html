<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Visualization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        canvas {
            max-width: 600px;
            max-height: 400px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="main-nav">
        <a class="main-nav-text" href="home.html">Home</a>
        <a class="main-nav-text" href="Statistics.html">Statistics</a>
        <a class="main-nav-text" href="Documents.html">Documents</a>
        <a class="main-nav-text" href="#">Katumajärvi-info</a>
        <a class="main-nav-text" href="#">Katumajärvi-info</a>
      </div>
    <h1>Visualize pH and Temperature from Excel</h1>

    <!-- First canvas for pH -->
    <h2>pH Values Over Time</h2>
    <canvas id="pHChart"></canvas>

    <!-- Second canvas for Temperature -->
    <h2>Temperature Values Over Time</h2>
    <canvas id="temperatureChart"></canvas>

    <script>
        // The URL of the Excel file
        const fileUrl = 'https://raw.githubusercontent.com/hiephamk/katuma1/main/Philip_Example_Of_Data.xlsx';

        // Fetch the file and process it
        fetch(fileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });

                // Assuming the first sheet is the one you want
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];

                // Convert the sheet to JSON
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                // Prepare data for Chart.js
                const labels = [];
                const pHData = [];
                const temperatureData = [];
                
                // Assuming the first row contains headers
                jsonData.forEach((row, index) => {
                    if (index === 0) {
                        // Skip the header row
                        return;
                    }
                    // Extract values from specific column indices (11th, 13th, 14th)
                    const tsValue = row[13]; // ts is in the 14th column (index 13)
                    const pHValue = row[11]; // pH is in the 12th column (index 11)
                    const temperatureValue = row[12]; // temperature is in the 13th column (index 12)
                    
                    // Push the values to the respective arrays
                    if (tsValue !== undefined && pHValue !== undefined && temperatureValue !== undefined) {
                        labels.push(tsValue); // ts values as labels
                        pHData.push(pHValue); // pH values
                        temperatureData.push(temperatureValue); // Temperature values
                    }
                });

                // Create pH Chart
                const pHCtx = document.getElementById('pHChart').getContext('2d');
                const pHChart = new Chart(pHCtx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'pH',
                            data: pHData,
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                // Create Temperature Chart
                const temperatureCtx = document.getElementById('temperatureChart').getContext('2d');
                const temperatureChart = new Chart(temperatureCtx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Temperature',
                            data: temperatureData,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Error fetching the Excel file:', error);
            });
    </script>
</body>
</html>
